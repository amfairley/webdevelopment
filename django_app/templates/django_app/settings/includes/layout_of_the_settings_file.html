{% extends 'includes/text_box.html' %}
{% load static %}

<!--Section ID to link in contents-->
{% block text_section_id %}Django-settings-layout-of-the-settings-file{% endblock %}

<!--Section title-->
{% block text_title %}Layout of the settings.py File{% endblock %}

<!--Section content-->
{% block text_content %}
    <!--Imports-->    
    <h4 id="Django-settings-layout-of-the-settings-file-imports">Imports</h4>
    <p>
        The top of the file has only one import from the inbuilt python library pathlib, that Django uses in order to 
        locate files and directories without the need for using strings for the paths. This provides various 
        functionalities to the user including checking the existence of a path and checking if it is a path to a file 
        or directory. This section will expand as you find the need for more libraries as your project grows but it is 
        best practice to keep all the imports at the top of the file like this.
    </p>
    {% include 'django_app/settings/includes/code_snippets/imports.html' %}

    <!--Base Directory Definition-->
    <h4 id="Django-settings-layout-of-the-settings-file-base-directory-definition">Base Directory Definition</h4>
    <p>
        This definition of the BASE_DIR variable should not be altered.
    </p> 
    {% include 'django_app/settings/includes/code_snippets/base_dir.html' %}
    <ul>
        <li>__file__ refers to the current file; settings.py</li>
        <li>.resolve() gets the absolute path of the file</li>
        <li>.parent moves one level up the root directory, so .parent.parent moves two levels up</li>
        <li>This final location acts as the base directory for your project</li>
    </ul>

    <!--Security Key-->
    <h4 id="Django-settings-layout-of-the-settings-file-security-key">Security Key</h4>
    <p>
        This is a very important variable for your project. Django uses this secret key as part of the algorithm to 
        <dfn title="The process of converting data into a fixed-length string of characters using a one-way cryptographic function">hash</dfn>
        user passwords, ensuring that user accounts remain safe, along with being used to create 
        <dfn title="Cross-Site Request Forgery tokens are unique, secret values generated by Django and included in web forms to protect against CSRF attacks">CSRF tokens</dfn>
        and data validation tokens. If this is leaked, it would allow attackers to impersonate users, decrypt session 
        data, and forge authentication tokens or bypass CSRF protection or generate valid reset links.
    </p>
    <p>
        If you have already pushed your project to GitHub, this value will be available to anyone looking through your 
        commit history, but that's not the end of the world as you can generate a new one. The
        <a 
            class="text-link"
            href="https://djecrety.ir/"
            title="Django secrety key generator"
            aria-label="Go to the Django secret key generator"
            target="_blank"
            rel="noopener noreferrer"
        >
            Django Secret Key Generator
        </a>
        can be used to create secret keys specifically for Django, matching their level of security. 
    </p>
    <p>
        It is best practice for reasons mentioned above to move this to your env.py file (or generate a new one and 
        move that).
    </p>
    {% include 'django_app/settings/includes/code_snippets/security_key.html' %}

    <!--Debug-->
    <h4 id="Django-settings-layout-of-the-settings-file-debug">Debug</h4>
    <p>
        You will find that when you create your project, the DEBUG variable is set to True. This is indispensable 
        throughout development, letting you, well, debug, any errors that may arise. However, for best practice, this 
        definition should be moved to your env.py file, allowing you have a debug mode on when making alterations 
        locally but having it turned off in the final deployed website.
    </p>
    <p>
        Having DEBUG=True on a deployed site can cause the following issues:
    </p>
    <ul>
        <li>
            Security Risks
            <ul>
                <li>
                    The debug mode will display detailed error messages that help you when you build a website. However 
                    the provided variables, database credentials, and file paths can be used by attackers to exploit 
                    vulnerabilities.
                </li>
            </ul>
        </li>
        <li>
            Performance Issues
            <ul>
                <li>
                    It's very handy to get detailed error reports when something goes wrong to help us pinpoint where 
                    the issue is and apply a fix. However, the extra logging and error reporting consumes system 
                    resources and can slow down your site which is not an ideal situation for your users.
                </li>
            </ul>
        </li>
    </ul>

    <!--Allowed Hosts-->
    <h4 id="Django-settings-layout-of-the-settings-file-allowed-hosts">Allowed Hosts</h4>
    <p>
        The ALLOWED_HOSTS variable is an added security measure that defines which host/domain names that your Django 
        application can serve, thereby preventing HTTP Host header attacks. This is a Python list of strings, so we can 
        now add either 'localhost' or '127.0.0.1' to this variable (or both) to cover our development and add your 
        deployed domain when the site goes live.
    </p>
    {% include 'django_app/settings/includes/code_snippets/allowed_hosts.html' %}

    <!--Installed Apps-->
    <h4 id="Django-settings-layout-of-the-settings-file-installed-apps">Installed Apps</h4>
    <p>
        The INSTALLED_APPS section defines the list of applications that are active in your Django project and include 
        built-in Django apps, third part apps or custom apps. Apps will be discussed more in their own section 
        <a 
            class="text-link"
            href="#"
            title="Go to the Django Apps section"
            aria-label="Go to the Django Apps section"
        >
            here
        </a>
        but for now it is best to know that this is where you add both downloaded apps and your own created apps in 
        order for them to work.
    </p>
    <p>
        Adding an app to this list makes them visible to Django and help it assess changes when migrating and 
        automatically integrate app features. 
    </p>
    {% include 'django_app/settings/includes/code_snippets/installed_apps.html' %}

    <!--Middleware-->
    <h4 id="Django-settings-layout-of-the-settings-file-middleware">Middleware</h4>
    <p>
        In Django, the MIDDLEWARE setting is a list of middleware components that sit between the request and response 
        phases of a web request. They act as a series of hooks that process incoming requests and outgoing responses. 
        Each middleware can:
    </p>
    <ul>
        <li>Process requests before views are called</li>
        <li>Process responses before they're returned to the browser</li>
        <li>Handle exceptions, redirects, authentication, security checks, etc.</li>
    </ul>
    <p>
        Here are the default ones and their uses:
    </p>
    {% include 'django_app/settings/includes/code_snippets/middleware.html' %}

    <!--ROOT_URLCONF-->
    <h4 id="Django-settings-layout-of-the-settings-file-root-urlconf">ROOT_URLCONF</h4>
    <p>
        This setting tells Django where to find the URL configuration for your project. It will link to the urls.py 
        file in your project name folder with dot notation. E.g.
    </p>
    {% include 'django_app/settings/includes/code_snippets/urlconf.html' %}
    <p>
        Will tell django to import project_name/urls.py
    </p>
    <p>
        So when a request comes in, Django looks at the ROOT_URLCONF to find the correct urls.py file, loads the list 
        of urlpatterns inside that file and matches the incoming URL against the patterns to find the right view to run.
    </p>

    <!--Templates-->
    <h4 id="Django-settings-layout-of-the-settings-file-templates">Templates</h4>
    <p>
        The TEMPLATES variable defines how Django handles rendering the HTML templates by defining the path to the 
        templates, which template engine to use and other settings for processing the templates.
    </p>
    <p>
        Here is an outline of the keys In the TEMPLATES dictionary:
    </p>
    <ul>
        <li>
            BACKEND:
            <ul>
                <li>
                    Defines which template engine should use, with the default being 
                    django.template.backends.django.DjangoTemplates which is the built-in template engine.
                </li>
                <li>
                    You can add third-part engines here such as Jinja2 with by replacing it with
                    django.template.backends.jinja2.Jinja2
                </li>
            </ul>
        </li>
        <li>
            DIRS:
            <ul>
                <li>
                    This is a list of directories that Django looks in for templates. By default it is empty. When 
                    adding directories here, the general syntax is
                </li>
                <li>
                    'DIRS': [os.path.join(BASE_DIR, 'templates')]
                </li>
                <li>
                    For child folders you can specify them like: <br>
                    'DIRS': [os.path.join(BASE_DIR, 'templates', 'allauth')] which will look in the allauth folder 
                    inside the templates folder in the root directory.
                </li>
            </ul>
        </li>
        <li>
            APP_DIRS:
            <ul>
                <li>
                    If True, Django will also look for templates inside each installed app's templates folder.
                </li>
                <li>
                    If False, Django will only use the directories specified in DIRS
                </li>
            </ul>
        </li>
        <li>
            OPTIONS:
            <ul>
                <li>
                    The most common setting here is the context processors that automatically add extra data to every 
                    template, so you can define your own and include them in this list 
                </li>
            </ul>
        </li>
    </ul>

    <!--WSGI_APPLICATION-->
    <h4 id="Django-settings-layout-of-the-settings-file-wsgi-application">WSGI_APPLICATION</h4>
    <p>
        This setting in settings.py tells Django where to find the 
        <dfn title="Web Server Gateway Interface">WSGI</dfn>
        application object that serves your project when it's deployed. It will be in the form of:
    </p>
    {% include 'django_app/settings/includes/code_snippets/wsgi.html' %}
    <p>
        Django will look in your project folder, find the wsgi.py file inside that folder and call the Python object 
        defined inside wsgi.py.
    </p>
    <p>
        The WSGI is a standard interface between your web server (like Gunicorn, uWSGI, or mod_wsgi), and your Python 
        web app (in this case, your Django project). When the server receives a request, it passes it to the 
        application object defined here. Django processes the request and returns a response through this same object.
    </p>

    <!--Databases-->
    <h4 id="Django-settings-layout-of-the-settings-file-databases">Databases</h4>
    <p>
        Here we can define our databases, for local development it would be the SQLite3 
        <dfn title="Relational Database Management System">RDBMS</dfn>
        but if you host your database on an external server such as PostgreSQL, you will need to define it here when 
        you deploy your app.
    </p>

    <!--AUTH_PASSWORD_VALIDATORS-->
    <h4 id="Django-settings-layout-of-the-settings-file-auth-password-validators">AUTH_PASSWORD_VALIDATORS</h4>
    <p>
        This  setting defines the password validation rules Django uses when users create or change their passwords. It 
        is a list of rules Django uses to enforce strong, secure passwords in order to protect your users from weak, 
        common, or easily guessed passwords during registration and password changes.
    </p>
    {% include 'django_app/settings/includes/code_snippets/auth_password_validators.html' %}
    <p>
        Each validator can also be configured with extra options. For example you can raise the minimum password length 
        to 12 characters.
    </p>
    {% include 'django_app/settings/includes/code_snippets/auth_password_validators_configuration.html' %}
    <p>
        The 
        <a 
            class="text-link"
            href="https://docs.djangoproject.com/en/5.2/topics/auth/passwords/#password-validation"
            title="Go to the password validation part of the documentation"
            aria-label="Go to the password validation part of the documentation"
            target="_blank"
            rel="noopener noreferrer"
        >
            Django Documentation
        </a>
        shows all other ways to customise these.
    </p>
    <!--Internationalization-->
    <h4 id="Django-settings-layout-of-the-settings-file-internationalization">Internationalization</h4>
    <p>
        These settings control how Django handles language, time, and localisation.
    </p>
    {% include 'django_app/settings/includes/code_snippets/internationalization.html' %}
    <p>
        You can set USE_I18N to False if your site is only ever in one language and you want to skip translation 
        overhead.
    </p>

    <!--Static Files-->
    <h4 id="Django-settings-layout-of-the-settings-file-static-files">Static Files</h4>
    <p>
        The pathway to your static files such as images and custom JavaScript code. We will update and expand this 
        section when adding our static files.
    </p>
    {% include 'django_app/settings/includes/code_snippets/static_files.html' %}

    <!--DEFAULT_AUTO_FIELD-->
    <h4 id="Django-settings-layout-of-the-settings-file-default-auto-field">DEFAULT_AUTO_FIELD</h4>
    <p>
        The DEFAULT_AUTO_FIELD controls the type of primary key field that Django automatically adds to your models when
        you don't explicitly define one. BigAutoField is a 64-bit integer that auto-increments. It's used as the id 
        field (the primary key) by default when you define a model.
    </p>
    {% include 'django_app/settings/includes/code_snippets/default_auto_field.html' %}
{% endblock %}